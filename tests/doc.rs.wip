use paste::paste;
use pretty_assertions::assert_eq;

mod test_utils;
use test_utils::*;

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
#[allow(dead_code)]
enum SingleVariantUnit {
    A,
}

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
#[allow(dead_code)]
enum MultiVariantUnit {
    A,
    B,
}

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
#[allow(dead_code)]
enum SingleVariantTuple {
    A(Usize),
}

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
#[allow(dead_code)]
enum MultiVariantTuple {
    A(Usize),
    B(Usize),
}

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
#[allow(dead_code)]
enum SingleVariantStruct {
    A { s: String },
}

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
#[allow(dead_code)]
enum MultiVariantStruct {
    A { s: String },
    B { num: Usize },
}

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
struct Newtype(Usize);

// TODO
// /// Hello World
// #[derive(Node, serde::Serialize)]
// #[zod(namespace = "Ns")]
// struct TupleStructMulti(Usize, String);

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
struct StructSingle {
    num: Usize,
}

/// Hello World
#[derive(Node, serde::Serialize)]
#[zod(namespace = "Ns")]
struct StructMulti {
    num: Usize,
    s: String,
}

#[derive(zod::Namespace)]
struct Ns;

fn main() {}

const DOC: &str = "Hello World";

macro_rules! case {
    ($name: ident, $t: ident) => {
        paste! {
            #[test]
            fn  [<$name _schema>] () {
                assert_eq!(
                    $t::docs().map(|docs| docs.as_ref()),
                    Some(DOC)
                );
            }
        }
    };
}

case!(enum_variant_unit_single, SingleVariantUnit);
case!(enum_variant_unit_multi, MultiVariantUnit);
case!(enum_variant_tuple_single, SingleVariantTuple);
case!(enum_variant_tuple_multi, MultiVariantTuple);
case!(enum_variant_struct_single, SingleVariantStruct);
case!(enum_variant_struct_multi, MultiVariantStruct);
case!(newtype, Newtype);
case!(struct_single, StructSingle);
case!(struct_multi, StructMulti);
// TODO
// case!(tuple_struct_multi, TupleStructMulti, "z.number", "number");
